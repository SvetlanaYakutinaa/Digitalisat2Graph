<!DOCTYPE html>
<html>
<head>
  <title>TTL-RDF Visualisierung</title>
  <script src="https://unpkg.com/vis-network/standalone/umd/vis-network.min.js"></script>
  <script src="https://unpkg.com/n3@1.14.0/browser/n3.min.js"></script>
  <style>
    #network {
      width: 100%;
      height: 800px;
      border: 1px solid lightgray;
    }
    #controls {
      margin: 1em 0;
    }
  </style>
</head>
<body>

<h2>ðŸ”— Turtle (.ttl) RDF-Visualisierung</h2>

<div id="controls">
  <label for="ttlInput">TTL-Datei hochladen:</label>
  <input type="file" id="ttlInput" accept=".ttl">
</div>

<div id="network"></div>

<script>
  const container = document.getElementById("network");

  function parseTTL(content) {
    const parser = new N3.Parser();
    const triples = [];

    parser.parse(content, (error, triple) => {
      if (triple) triples.push(triple);
    });

    return triples;
  }

  function drawGraph(triples) {
    const nodes = new vis.DataSet();
    const edges = [];
    const nodeSet = new Set();

    triples.forEach(({ subject, predicate, object }) => {
      if (!nodeSet.has(subject)) {
        nodes.add({ id: subject, label: subject, group: "node" });
        nodeSet.add(subject);
      }
      if (!nodeSet.has(object)) {
        nodes.add({ id: object, label: object, group: "node" });
        nodeSet.add(object);
      }

      edges.push({
        from: subject,
        to: object,
        label: predicate,
        arrows: "to",
        font: { align: "middle" }
      });
    });

    const data = { nodes, edges };
    const options = {
      nodes: {
        shape: "ellipse",
        font: { size: 14 },
        color: { background: "#DDEEFF" }
      },
      edges: {
        smooth: true,
        arrows: "to"
      },
      physics: true
    };

    new vis.Network(container, data, options);
  }

  document.getElementById("ttlInput").addEventListener("change", function (e) {
    const file = e.target.files[0];
    if (!file) return;

    const reader = new FileReader();
    reader.onload = function (e) {
      const ttlContent = e.target.result;
      const triples = parseTTL(ttlContent);
      drawGraph(triples);
    };
    reader.readAsText(file, "utf-8");
  });
</script>

</body>
</html>
